{
  "name": "img copy (PUBLIC TEMPLATE)",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [-1024, 0],
      "id": "manual_trigger",
      "name": "When clicking ‘Execute workflow’"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-5.1",
          "mode": "list"
        },
        "responses": {
          "values": [
            {
              "role": "system",
              "content": "=SYSTEM PROMPT (WITH BRAND AUTO-REPLACEMENT + PRODUCT PRESERVATION)\n\nYou are an Ad Image Reverse-Engineering + Style Transfer Prompt Generator.\n\n[UNCHANGED SYSTEM PROMPT CONTENT]\n"
            },
            {
              "type": "image",
              "imageUrl": "={{ $json.shuty }}"
            }
          ]
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 2.1,
      "position": [-272, -144],
      "id": "openai_node",
      "name": "Message a model",
      "credentials": {
        "openAiApi": {
          "name": "OPENAI_API (USER MUST CREATE)"
        }
      }
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1,
      "position": [480, 0],
      "id": "wait_node",
      "name": "Wait"
    },
    {
      "parameters": {
        "conditions": {
          "conditions": [
            {
              "leftValue": "={{ $json.data.state }}",
              "rightValue": "success",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ]
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [1136, 0],
      "id": "if_node",
      "name": "If"
    },
    {
      "parameters": {
        "resource": "message",
        "guildId": "DISCORD_GUILD_ID_HERE",
        "channelId": "DISCORD_CHANNEL_ID_HERE",
        "content": "={{ $json.data.resultJson.extractUrl() }}"
      },
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [1472, -128],
      "id": "discord_node",
      "name": "Send a message",
      "credentials": {
        "discordBotApi": {
          "name": "DISCORD_BOT_TOKEN (USER MUST CREATE)"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "name": "shuty",
              "value": "=[\n  \"IMAGE_URL_1\",\n  \"IMAGE_URL_2\",\n  \"IMAGE_URL_3\"\n]",
              "type": "array"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3,
      "position": [-720, 0],
      "id": "set_images",
      "name": "Set inspiration images (USER INPUT)"
    },
    {
      "parameters": {
        "jsCode": "// Clean model output\nreturn $input.all().map(item => ({ json: { prompt: item.json.output[0].content[0].text } }));"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [32, 0],
      "id": "clean_node",
      "name": "Clean prompt"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.kie.ai/api/v1/jobs/createTask",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer KIE_API_KEY_HERE"
            }
          ]
        },
        "sendBody": true,
        "jsonBody": "={\n  \"model\": \"nano-banana-pro\",\n  \"input\": {\n    \"prompt\": \"{{ $json.prompt }}\",\n    \"aspect_ratio\": \"1:1\",\n    \"resolution\": \"1K\",\n    \"image_input\": [\"PRODUCT_IMAGE_URL_HERE\"],\n    \"output_format\": \"png\"\n  }\n}"
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [272, 0],
      "id": "kie_create",
      "name": "KIE – Create Job"
    },
    {
      "parameters": {
        "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "taskId",
              "value": "={{ $('kie_create').item.json.data.taskId }}"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer KIE_API_KEY_HERE"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [688, 0],
      "id": "kie_status",
      "name": "KIE – Check Status"
    }
  ],
  "active": false
}
